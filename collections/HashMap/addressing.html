<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>HashMapå¯»å€ç®—æ³• - å¿«é€’åˆ†æ‹£ç«™å®ä¾‹</title>
    <style>
      * {
        box-sizing: border-box;
        margin: 0;
        padding: 0;
      }

      body {
        max-width: 1200px;
        margin: 0 auto;
        padding: 20px;
        color: #333;
        font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        line-height: 1.6;
        background: linear-gradient(135deg, #f0f7ff 0%, #e6f0ff 100%);
      }

      .container {
        display: grid;
        grid-template-columns: 1fr;
        gap: 30px;
      }

      header {
        margin-bottom: 30px;
        padding: 40px 0;
        color: white;
        text-align: center;
        background: linear-gradient(90deg, #1a6dcc, #0d4a9e);
        border-radius: 15px;
        box-shadow: 0 8px 16px rgba(0, 0, 0, 0.2);
      }

      h1 {
        margin-bottom: 15px;
        font-size: 2.8rem;
        letter-spacing: 1px;
      }

      .subtitle {
        max-width: 800px;
        margin: 0 auto;
        font-weight: 300;
        font-size: 1.3rem;
        opacity: 0.9;
      }

      .analogy-section {
        margin-bottom: 30px;
        padding: 30px;
        background: white;
        border-radius: 15px;
        box-shadow: 0 8px 20px rgba(0, 0, 0, 0.1);
      }

      .analogy-header {
        display: flex;
        align-items: center;
        margin-bottom: 30px;
        padding-bottom: 20px;
        border-bottom: 2px solid #1a6dcc;
      }

      .analogy-icon {
        margin-right: 20px;
        color: #1a6dcc;
        font-size: 3rem;
      }

      .analogy-content {
        display: grid;
        grid-template-columns: 1fr 1fr;
        gap: 30px;
      }

      .analogy-box {
        padding: 25px;
        background: #f5f9ff;
        border-left: 4px solid #1a6dcc;
        border-radius: 10px;
      }

      .analogy-box h3 {
        display: flex;
        align-items: center;
        margin-bottom: 20px;
        color: #0d4a9e;
      }

      .analogy-box h3 i {
        margin-right: 10px;
      }

      .analogy-box ul {
        margin-left: 25px;
      }

      .analogy-box li {
        margin-bottom: 15px;
        font-size: 1.1rem;
        line-height: 1.6;
      }

      .analogy-box li strong {
        color: #e74c3c;
      }

      .visualization {
        margin-bottom: 30px;
        padding: 30px;
        background: white;
        border-radius: 15px;
        box-shadow: 0 8px 20px rgba(0, 0, 0, 0.1);
      }

      .visual-header {
        margin-bottom: 30px;
        color: #0d4a9e;
        text-align: center;
      }

      .warehouse {
        display: flex;
        justify-content: center;
        margin-bottom: 40px;
      }

      .shelf {
        display: flex;
        flex-direction: column;
        align-items: center;
        margin: 0 20px;
      }

      .shelf-label {
        margin-bottom: 10px;
        color: #0d4a9e;
        font-weight: bold;
      }

      .bin {
        position: relative;
        display: flex;
        flex-direction: column;
        align-items: center;
        justify-content: center;
        width: 100px;
        height: 100px;
        margin: 10px 0;
        overflow: hidden;
        background: #e6f0ff;
        border: 3px solid #1a6dcc;
        border-radius: 8px;
        transition: all 0.3s ease;
      }

      .bin-number {
        color: #0d4a9e;
        font-weight: bold;
        font-size: 1.5rem;
      }

      .bin-content {
        padding: 5px;
        font-size: 0.9rem;
        text-align: center;
      }

      .bin.active {
        background: #ffeb3b;
        border-color: #ff9800;
        box-shadow: 0 5px 15px rgba(255, 152, 0, 0.3);
        transform: scale(1.05);
      }

      .bin.active .bin-number {
        color: #e74c3c;
      }

      .package {
        display: flex;
        align-items: center;
        justify-content: center;
        width: 80px;
        height: 40px;
        margin: 10px 0;
        color: white;
        font-weight: bold;
        background: #4caf50;
        border-radius: 5px;
        box-shadow: 0 3px 6px rgba(0, 0, 0, 0.2);
        cursor: pointer;
        transition: all 0.3s ease;
      }

      .package:hover {
        transform: translateY(-5px);
      }

      .calculation {
        margin: 30px 0;
        padding: 25px;
        color: white;
        font-size: 1.2rem;
        font-family: monospace;
        line-height: 1.8;
        background: #2c3e50;
        border-radius: 10px;
      }

      .highlight {
        color: #ffeb3b;
        font-weight: bold;
      }

      .interactive-section {
        padding: 30px;
        background: white;
        border-radius: 15px;
        box-shadow: 0 8px 20px rgba(0, 0, 0, 0.1);
      }

      .input-group {
        display: grid;
        grid-template-columns: 1fr 1fr;
        gap: 20px;
        margin-bottom: 25px;
      }

      .input-column {
        display: flex;
        flex-direction: column;
      }

      .input-column label {
        margin-bottom: 10px;
        color: #2c3e50;
        font-weight: 600;
        font-size: 1.1rem;
      }

      input[type='text'],
      select {
        width: 100%;
        padding: 12px 15px;
        font-size: 1.1rem;
        border: 2px solid #ddd;
        border-radius: 8px;
        transition: border-color 0.3s;
      }

      input[type='text']:focus,
      select:focus {
        border-color: #1a6dcc;
        outline: none;
        box-shadow: 0 0 0 3px rgba(26, 109, 204, 0.2);
      }

      button {
        width: 100%;
        margin-top: 10px;
        padding: 15px 30px;
        color: white;
        font-weight: 600;
        font-size: 1.1rem;
        background: linear-gradient(to right, #1a6dcc, #0d4a9e);
        border: none;
        border-radius: 8px;
        box-shadow: 0 5px 15px rgba(0, 0, 0, 0.15);
        cursor: pointer;
        transition: all 0.3s ease;
      }

      button:hover {
        box-shadow: 0 8px 20px rgba(0, 0, 0, 0.2);
        transform: translateY(-3px);
      }

      .results {
        margin-top: 25px;
        padding: 20px;
        background: #eaf7ff;
        border-left: 4px solid #1a6dcc;
        border-radius: 10px;
      }

      .result-item {
        margin-bottom: 15px;
        padding: 12px;
        font-size: 1.1rem;
        background: white;
        border-radius: 8px;
      }

      .result-item strong {
        color: #e74c3c;
      }

      .conclusion {
        margin-top: 25px;
        padding: 25px;
        background: #eaf7ff;
        border-left: 4px solid #4caf50;
        border-radius: 10px;
      }

      .conclusion h3 {
        margin-bottom: 15px;
        color: #2c3e50;
        font-size: 1.5rem;
      }

      .conclusion p {
        margin-bottom: 15px;
        font-size: 1.1rem;
        line-height: 1.7;
      }

      .conclusion ul {
        margin-bottom: 20px;
        margin-left: 25px;
      }

      .conclusion li {
        margin-bottom: 10px;
        font-size: 1.1rem;
      }

      footer {
        margin-top: 40px;
        padding: 25px;
        color: #7f8c8d;
        font-size: 1rem;
        font-style: italic;
        text-align: center;
        border-top: 1px solid #eee;
      }

      @media (max-width: 900px) {
        .analogy-content {
          grid-template-columns: 1fr;
        }

        .input-group {
          grid-template-columns: 1fr;
        }

        .warehouse {
          flex-direction: column;
          align-items: center;
        }

        .shelf {
          margin: 20px 0;
        }
      }
    </style>
  </head>
  <body>
    <div class="container">
      <header>
        <h1>HashMapå¯»å€ç®—æ³•</h1>
        <div class="subtitle">å¿«é€’åˆ†æ‹£ç«™å®ä¾‹ - å¤§ç™½è¯è§£é‡Šè®¡ç®—æœºç§‘å­¦æ¦‚å¿µ</div>
      </header>

      <div class="analogy-section">
        <div class="analogy-header">
          <div class="analogy-icon">ğŸ“¦</div>
          <div>
            <h2>å¿«é€’åˆ†æ‹£ç«™ç±»æ¯”</h2>
            <p>æŠŠHashMapæƒ³è±¡æˆä¸€ä¸ªå¿«é€’åˆ†æ‹£ä¸­å¿ƒï¼Œå¿«é€Ÿå°†åŒ…è£¹åˆ†å‘åˆ°æ­£ç¡®çš„è´§æ¶</p>
          </div>
        </div>

        <div class="analogy-content">
          <div class="analogy-box">
            <h3><i>ğŸ“¦</i> å¿«é€’åˆ†æ‹£ç«™</h3>
            <ul>
              <li><strong>å¿«é€’åŒ…è£¹</strong> â†’ HashMapçš„é”®å€¼å¯¹ï¼ˆKey-Valueï¼‰</li>
              <li><strong>åˆ†æ‹£ä¸­å¿ƒ</strong> â†’ HashMapå†…éƒ¨å­˜å‚¨ç»“æ„</li>
              <li>
                <strong>åˆ†æ‹£ç­ï¼ˆè´§æ¶æ ¼å­ï¼‰</strong> â†’ HashMapçš„æ¡¶ï¼ˆBucketï¼‰
              </li>
              <li><strong>å¿«é€’å•å·</strong> â†’ é”®ï¼ˆKeyï¼‰çš„å“ˆå¸Œå€¼</li>
              <li><strong>åˆ†æ‹£ç®—æ³•</strong> â†’ HashMapçš„å¯»å€ç®—æ³•</li>
              <li><strong>åˆ†æ‹£å‘˜</strong> â†’ HashMapçš„put/getæ–¹æ³•</li>
            </ul>
          </div>

          <div class="analogy-box">
            <h3><i>âš™ï¸</i> åˆ†æ‹£è¿‡ç¨‹</h3>
            <ul>
              <li>
                1. <strong>æ‰«æå¿«é€’å•</strong>ï¼šè®¡ç®—é”®çš„å“ˆå¸Œå€¼ï¼ˆhashCodeï¼‰
              </li>
              <li>
                2.
                <strong>ä¼˜åŒ–å•å·</strong
                >ï¼šæ‰°åŠ¨å‡½æ•°å¤„ç†å“ˆå¸Œå€¼ï¼ˆé¿å…ç›¸ä¼¼å•å·æ‰å †ï¼‰
              </li>
              <li>
                3. <strong>è®¡ç®—ç­å·</strong>ï¼š<code
                  >ç­å· = ä¼˜åŒ–åå•å· & (ç­æ€»æ•° - 1)</code
                >
              </li>
              <li>4. <strong>æ”¾å…¥ç­ä¸­</strong>ï¼šå°†åŒ…è£¹æ”¾å…¥å¯¹åº”ç­ï¼ˆæ¡¶ï¼‰</li>
              <li>
                5.
                <strong>ç­æ»¡æ‰©å®¹</strong>ï¼šå½“ç­å¤ªå¤šåŒ…è£¹æ—¶ï¼Œå¢åŠ ç­æ•°é‡å¹¶é‡æ–°åˆ†æ‹£
              </li>
            </ul>
          </div>
        </div>
      </div>

      <div class="visualization">
        <h2 class="visual-header">å¿«é€’åˆ†æ‹£è¿‡ç¨‹å¯è§†åŒ–</h2>

        <div class="warehouse">
          <div class="shelf">
            <div class="shelf-label">å¾…åˆ†æ‹£åŒ…è£¹</div>
            <div class="package" id="pkg1">JD-12345</div>
            <div class="package" id="pkg2">SF-67890</div>
            <div class="package" id="pkg3">YT-24680</div>
          </div>

          <div class="shelf">
            <div class="shelf-label">åˆ†æ‹£ä¸­å¿ƒ (8ä¸ªç­)</div>
            <div class="bin" id="bin0">
              <div class="bin-number">0</div>
              <div class="bin-content"></div>
            </div>
            <div class="bin" id="bin1">
              <div class="bin-number">1</div>
              <div class="bin-content"></div>
            </div>
            <div class="bin" id="bin2">
              <div class="bin-number">2</div>
              <div class="bin-content"></div>
            </div>
            <div class="bin" id="bin3">
              <div class="bin-number">3</div>
              <div class="bin-content"></div>
            </div>
            <div class="bin" id="bin4">
              <div class="bin-number">4</div>
              <div class="bin-content"></div>
            </div>
            <div class="bin" id="bin5">
              <div class="bin-number">5</div>
              <div class="bin-content"></div>
            </div>
            <div class="bin" id="bin6">
              <div class="bin-number">6</div>
              <div class="bin-content"></div>
            </div>
            <div class="bin" id="bin7">
              <div class="bin-number">7</div>
              <div class="bin-content"></div>
            </div>
          </div>
        </div>

        <div class="calculation">
          // åˆ†æ‹£ç®—æ³•æ ¸å¿ƒä»£ç ï¼š<br />
          int <span class="highlight">hash</span> = key.hashCode() ^
          (key.hashCode() >>> 16);<br />
          int <span class="highlight">index</span> = hash & (n - 1); //
          næ˜¯ç­çš„æ•°é‡ï¼ˆå½“å‰ä¸º8ï¼‰
        </div>

        <div class="interactive-section">
          <h3>äº²è‡ªä½“éªŒåˆ†æ‹£è¿‡ç¨‹</h3>

          <div class="input-group">
            <div class="input-column">
              <label for="packageId">è¾“å…¥å¿«é€’å•å·ï¼š</label>
              <input
                type="text"
                id="packageId"
                value="JD-12345"
                placeholder="ä¾‹å¦‚ï¼šJD-12345"
              />
            </div>

            <div class="input-column">
              <label for="binCount">é€‰æ‹©åˆ†æ‹£ç­æ•°é‡ï¼š</label>
              <select id="binCount">
                <option value="8">8ä¸ªç­</option>
                <option value="16">16ä¸ªç­</option>
                <option value="32">32ä¸ªç­</option>
              </select>
            </div>
          </div>

          <button id="sortBtn">å¼€å§‹åˆ†æ‹£</button>

          <div class="results">
            <div class="result-item">
              <strong>å¿«é€’å•å·ï¼š</strong> <span id="packageResult"></span>
            </div>
            <div class="result-item">
              <strong>åŸå§‹å“ˆå¸Œå€¼ï¼š</strong> <span id="hashOriginal"></span>
            </div>
            <div class="result-item">
              <strong>æ‰°åŠ¨åå“ˆå¸Œå€¼ï¼š</strong> <span id="hashDisturbed"></span>
            </div>
            <div class="result-item">
              <strong>åˆ†æ‹£ç­å·ï¼š</strong> <span id="binResult"></span>
            </div>
          </div>
        </div>
      </div>

      <div class="conclusion">
        <h3>HashMapå¯»å€æ ¸å¿ƒåŸç†</h3>
        <ul>
          <li>
            <strong>é—ªç”µå®šä½</strong>ï¼šä½¿ç”¨ä½è¿ç®— <code>&</code> æ›¿ä»£å–æ¨¡è¿ç®—
            <code>%</code>ï¼Œé€Ÿåº¦æå‡10å€ä»¥ä¸Š
          </li>
          <li>
            <strong>é¿å…æ‰å †</strong>ï¼šå“ˆå¸Œæ‰°åŠ¨å‡½æ•°è®©ç›¸ä¼¼é”®å€¼åˆ†æ•£åˆ°ä¸åŒä½ç½®
          </li>
          <li>
            <strong>åŠ¨æ€æ‰©å®¹</strong>ï¼šå½“å…ƒç´ è¿‡å¤šæ—¶è‡ªåŠ¨å¢åŠ "ç­"çš„æ•°é‡ï¼ˆæ¡¶æ‰©å®¹ï¼‰
          </li>
          <li><strong>é«˜æ•ˆæŸ¥æ‰¾</strong>ï¼šç›´æ¥è®¡ç®—ä½ç½®ï¼Œæ— éœ€éå†æ•´ä¸ªä»“åº“</li>
          <li>
            <strong>2çš„næ¬¡æ–¹</strong>ï¼šç­æ•°é‡æ€»æ˜¯2çš„å¹‚æ¬¡ï¼ˆ8,16,32...ï¼‰ï¼Œç¡®ä¿
            <code>& (n-1)</code> ç­‰æ•ˆå–æ¨¡
          </li>
        </ul>
        <p>
          HashMapå°±åƒæ™ºèƒ½å¿«é€’åˆ†æ‹£ç³»ç»Ÿï¼Œæ— è®ºæ¥å¤šå°‘åŒ…è£¹ï¼Œéƒ½èƒ½ç¬é—´ç®—å‡ºæ­£ç¡®ä½ç½®ï¼Œæ¯”äººå·¥åˆ†æ‹£å¿«Nå€ï¼
        </p>
      </div>

      <footer>
        <p>HashMapå¯»å€ç®—æ³•è§£æ | å¿«é€’åˆ†æ‹£ç«™å®ä¾‹ | è®¡ç®—æœºç§‘å­¦å¯è§†åŒ–è§£é‡Š</p>
      </footer>
    </div>

    <script>
      // åŒ…è£¹ç‚¹å‡»äº‹ä»¶
      document.querySelectorAll('.package').forEach((pkg) => {
        pkg.addEventListener('click', function () {
          sortPackage(this.id, this.textContent)
        })
      })

      // åˆ†æ‹£æŒ‰é’®äº‹ä»¶
      document.getElementById('sortBtn').addEventListener('click', function () {
        const packageId = document.getElementById('packageId').value
        sortPackage('customPkg', packageId)
      })

      // åˆ†æ‹£åŒ…è£¹å‡½æ•°
      function sortPackage(elementId, packageId) {
        // é‡ç½®æ‰€æœ‰ç­çš„æ¿€æ´»çŠ¶æ€
        document.querySelectorAll('.bin').forEach((bin) => {
          bin.classList.remove('active')
          bin.querySelector('.bin-content').textContent = ''
        })

        // è®¡ç®—å“ˆå¸Œå€¼
        const hashCode = stringHash(packageId)
        const disturbedHash = hashCode ^ (hashCode >>> 16)

        // è·å–ç­æ•°é‡
        const binCount = parseInt(document.getElementById('binCount').value)
        const binIndex = disturbedHash & (binCount - 1)

        // æ›´æ–°ç»“æœ
        document.getElementById('packageResult').textContent = packageId
        document.getElementById('hashOriginal').textContent = hashCode
        document.getElementById('hashDisturbed').textContent = disturbedHash
        document.getElementById('binResult').textContent = binIndex

        // é«˜äº®ç›®æ ‡ç­
        const targetBin = document.getElementById(`bin${binIndex}`)
        targetBin.classList.add('active')
        targetBin.querySelector('.bin-content').textContent = packageId

        // å¦‚æœæ˜¯ç‚¹å‡»åŒ…è£¹ï¼Œæ·»åŠ åŠ¨ç”»æ•ˆæœ
        if (elementId !== 'customPkg') {
          const packageEl = document.getElementById(elementId)
          packageEl.style.transform = 'scale(0.9)'
          setTimeout(() => {
            packageEl.style.transform = 'scale(1)'
          }, 300)
        }
      }

      // ç®€å•å­—ç¬¦ä¸²å“ˆå¸Œå‡½æ•°
      function stringHash(str) {
        let hash = 0
        for (let i = 0; i < str.length; i++) {
          hash = (hash << 5) - hash + str.charCodeAt(i)
          hash |= 0 // è½¬æ¢ä¸º32ä½æ•´æ•°
        }
        return Math.abs(hash)
      }

      // åˆå§‹åŒ–ï¼šåˆ†æ‹£ç¬¬ä¸€ä¸ªåŒ…è£¹
      setTimeout(() => {
        sortPackage('pkg1', 'JD-12345')
      }, 1000)
    </script>
  </body>
</html>
